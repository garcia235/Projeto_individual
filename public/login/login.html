<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../globais/style_footer.css">
  <link rel="stylesheet" href="../globais/style_navbar.css">
  <link rel="stylesheet" href="../globais/navbar.js   ">
  <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.0/css/bootstrap.min.css'>
  <link rel='stylesheet' href='https://unicons.iconscout.com/release/v2.1.9/css/unicons.css'>
  <script src="../js/funcoes.js"></script>
  <link rel="stylesheet" href="style_login.css">
  <link
        href="https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">
  <title>Log In</title>
</head>

<body>

  <header>
    <div class="container">
      <div class="css-1vs2kf0">
        <div style="transform: scale(1)">
          <svg width="150" height="101" viewBox="0 0 369 150" class="css-1j8o68f">
            <defs id="SvgjsDefs1661">
              <linearGradient id="SvgjsLinearGradient1666">
                <stop id="SvgjsStop1667" stop-color="#8f5e25" offset="0"></stop>
                <stop id="SvgjsStop1668" stop-color="#fbf4a1" offset="0.5"></stop>
                <stop id="SvgjsStop1669" stop-color="#8f5e25" offset="1"></stop>
              </linearGradient>
              <linearGradient id="SvgjsLinearGradient1670">
                <stop id="SvgjsStop1671" stop-color="#8f5e25" offset="0"></stop>
                <stop id="SvgjsStop1672" stop-color="#fbf4a1" offset="0.5"></stop>
                <stop id="SvgjsStop1673" stop-color="#8f5e25" offset="1"></stop>
              </linearGradient>
            </defs>
            <g id="SvgjsG1662" featurekey="symbolFeature-0"
              transform="matrix(0.8753111257174382,0,0,0.8753111257174382,0,-0.00043965857365255666)"
              fill="url(#SvgjsLinearGradient1666)">
              <path xmlns="http://www.w3.org/2000/svg"
                d="M43.463,100c-0.207,0-0.414-0.054-0.598-0.161l-42.266-24.4C0.229,75.226,0,74.83,0,74.403V25.599  c0-0.428,0.228-0.822,0.598-1.035L42.865,0.163c0.568-0.334,1.303-0.136,1.634,0.437c0.331,0.572,0.135,1.304-0.438,1.633  L2.394,26.291v47.42l41.069,23.712l41.069-23.712V25.599c0-0.661,0.535-1.196,1.196-1.196s1.196,0.535,1.196,1.196v48.805  c0,0.427-0.229,0.822-0.598,1.035l-42.266,24.4C43.876,99.946,43.67,100,43.463,100z">
              </path>
              <path xmlns="http://www.w3.org/2000/svg"
                d="M16.785,34.626c-0.18,0-0.363-0.04-0.536-0.126L0.66,26.669c-0.59-0.297-0.829-1.017-0.532-1.608  c0.297-0.589,1.012-0.832,1.606-0.533l15.589,7.831c0.59,0.297,0.829,1.017,0.532,1.608C17.645,34.385,17.223,34.626,16.785,34.626z  ">
              </path>
              <path xmlns="http://www.w3.org/2000/svg"
                d="M43.463,100c-0.661,0-1.196-0.535-1.196-1.196V81.364c0-0.661,0.535-1.196,1.196-1.196s1.196,0.535,1.196,1.196v17.439  C44.659,99.465,44.124,100,43.463,100z">
              </path>
              <path xmlns="http://www.w3.org/2000/svg"
                d="M43.462,81.577c-0.192,0-0.386-0.047-0.566-0.143L16.22,67.077c-0.388-0.208-0.629-0.614-0.629-1.054l-0.001-32.594  c0-0.661,0.535-1.196,1.197-1.196c0.661,0,1.196,0.535,1.196,1.196l0.001,31.878L44.03,79.326c0.582,0.313,0.8,1.04,0.487,1.622  C44.301,81.348,43.888,81.577,43.462,81.577z">
              </path>
              <path xmlns="http://www.w3.org/2000/svg"
                d="M16.788,34.626c-0.41,0-0.81-0.21-1.033-0.591c-0.334-0.568-0.144-1.302,0.425-1.636l26.676-15.675  c0.569-0.336,1.304-0.147,1.638,0.425c0.335,0.568,0.145,1.301-0.425,1.636L17.394,34.46C17.203,34.572,16.994,34.626,16.788,34.626  z">
              </path>
              <path xmlns="http://www.w3.org/2000/svg"
                d="M16.99,67.203c-0.41,0-0.81-0.21-1.033-0.591c-0.334-0.568-0.144-1.302,0.425-1.636L43.06,49.301  c0.569-0.336,1.304-0.147,1.639,0.425c0.334,0.568,0.144,1.301-0.426,1.636L17.596,67.037C17.405,67.149,17.196,67.203,16.99,67.203  z">
              </path>
              <path xmlns="http://www.w3.org/2000/svg"
                d="M43.463,51.701c-0.661,0-1.196-0.535-1.196-1.197v-32.75c0-0.661,0.535-1.196,1.196-1.196s1.196,0.535,1.196,1.196v32.75  C44.659,51.166,44.124,51.701,43.463,51.701z">
              </path>
              <path xmlns="http://www.w3.org/2000/svg"
                d="M43.463,100c-0.207,0-0.414-0.054-0.598-0.161l-42.266-24.4C0.229,75.226,0,74.83,0,74.403V25.599  c0-0.661,0.535-1.196,1.197-1.196c0.661,0,1.196,0.535,1.196,1.196v48.112l41.069,23.712l41.069-23.712v-47.42L42.865,2.233  c-0.573-0.33-0.769-1.061-0.438-1.633c0.329-0.573,1.062-0.771,1.634-0.437l42.266,24.401c0.369,0.213,0.598,0.607,0.598,1.035  v48.805c0,0.427-0.229,0.822-0.598,1.035l-42.266,24.4C43.876,99.946,43.67,100,43.463,100z">
              </path>
              <path xmlns="http://www.w3.org/2000/svg"
                d="M70.143,34.626c-0.438,0-0.86-0.241-1.07-0.659c-0.295-0.591-0.057-1.311,0.532-1.608l15.587-7.831  c0.596-0.297,1.309-0.056,1.607,0.533c0.295,0.591,0.057,1.311-0.532,1.608L70.68,34.5C70.507,34.586,70.324,34.626,70.143,34.626z">
              </path>
              <path xmlns="http://www.w3.org/2000/svg"
                d="M43.463,100c-0.661,0-1.196-0.535-1.196-1.196V80.381c0-0.662,0.535-1.197,1.196-1.197s1.196,0.535,1.196,1.197v18.423  C44.659,99.465,44.124,100,43.463,100z">
              </path>
              <path xmlns="http://www.w3.org/2000/svg"
                d="M43.464,81.577c-0.426,0-0.839-0.229-1.055-0.629c-0.313-0.582-0.095-1.309,0.487-1.622l26.045-14.019l0.004-31.878  c0-0.661,0.538-1.196,1.197-1.196l0,0c0.661,0,1.196,0.535,1.196,1.196l-0.005,32.594c0,0.439-0.24,0.846-0.629,1.054L44.03,81.435  C43.85,81.53,43.656,81.577,43.464,81.577z">
              </path>
              <path xmlns="http://www.w3.org/2000/svg"
                d="M70.138,34.626c-0.206,0-0.416-0.054-0.605-0.166L42.856,18.785c-0.569-0.334-0.759-1.068-0.425-1.636  c0.336-0.573,1.068-0.762,1.638-0.425l26.676,15.675c0.57,0.334,0.76,1.068,0.425,1.636C70.946,34.416,70.549,34.626,70.138,34.626z  ">
              </path>
              <path xmlns="http://www.w3.org/2000/svg"
                d="M69.937,67.203c-0.206,0-0.414-0.054-0.603-0.166L42.657,51.362c-0.569-0.335-0.759-1.068-0.425-1.636  c0.336-0.572,1.068-0.762,1.638-0.425l26.674,15.676c0.57,0.334,0.762,1.067,0.426,1.636C70.747,66.993,70.348,67.203,69.937,67.203  z">
              </path>
              <path xmlns="http://www.w3.org/2000/svg"
                d="M43.463,51.701c-0.661,0-1.196-0.535-1.196-1.197v-32.75c0-0.661,0.535-1.196,1.196-1.196s1.196,0.535,1.196,1.196v32.75  C44.659,51.166,44.124,51.701,43.463,51.701z">
              </path>
            </g>
            <g id="SvgjsG1663" featurekey="nameFeature-0"
              transform="matrix(1.2537213879290394,0,0,1.2537213879290394,92.38928225928734,11.955345736135301)"
              fill="url(#SvgjsLinearGradient1670)">
              <path
                d="M17.68 12 c2.76 0 5 2.24 5 5 l0 5.28 c0 1.84 -1.32 3.4 -3.16 3.68 l-0.24 0.04 l0.24 0.04 c1.84 0.32 3.16 1.88 3.16 3.68 l0 5.32 c0 2.72 -2.24 4.96 -5 4.96 l-14.8 0 l0 -28 l14.8 0 z M16.28 32.28 l0 -1.72 c0 -0.76 -0.6 -1.32 -1.32 -1.32 l-5.68 0 l0 4.36 l5.68 0 c0.72 0 1.32 -0.6 1.32 -1.32 z M16.28 21.48 l0 -1.72 c0 -0.72 -0.6 -1.32 -1.32 -1.32 l-5.68 0 l0 4.36 l5.68 0 c0.72 0 1.32 -0.6 1.32 -1.32 z M41.36 33.6 l0 -21.6 l6.4 0 l0 23.04 c0 2.76 -2.24 4.96 -5 4.96 l-9.84 0 c-2.76 0 -4.96 -2.2 -4.96 -4.96 l0 -23.04 l6.4 0 l0 21.6 l7 0 z M53.52 12 l19.84 0 l0 6.44 l-6.72 0 l0 21.56 l-6.4 0 l0 -21.56 l-6.72 0 l0 -6.44 z M79.12 12 l19.84 0 l0 6.44 l-6.72 0 l0 21.56 l-6.4 0 l0 -21.56 l-6.72 0 l0 -6.44 z M122.32000000000001 18.44 l-11.2 0 l0 4.36 l8.04 0 l0 6.4 l-8.04 0 l0 4.4 l11.2 0 l0 6.4 l-17.6 0 l0 -28 l17.6 0 l0 6.44 z M142.88 12 c2.76 0 5 2.24 5 5 l0 10.52 c0 2.12 -1.32 3.92 -3.16 4.64 l3.16 7.84 l-6.8 0 l-3.04 -7.48 l-3.56 0 l0 7.48 l-6.4 0 l0 -28 l14.8 0 z M140.16 26.08 c0.72 0 1.32 -0.56 1.32 -1.28 l0 -5.08 c0 -0.72 -0.6 -1.28 -1.32 -1.28 l-5.68 0 l0 7.64 l5.68 0 z M171.12 18.44 l-11.2 0 l0 4.36 l8.04 0 l0 6.4 l-8.04 0 l0 10.8 l-6.4 0 l0 -28 l17.6 0 l0 6.44 z M183.28 12 l0 21.6 l10.32 0 l0 6.4 l-16.72 0 l0 0 l0 -28 l6.4 0 z M210.35999999999999 22.2 l4.6 -10.2 l6.4 0 l-7.8 17.32 l0 10.68 l-6.4 0 l0 -10.68 l-7.8 -17.32 l6.44 0 z">
              </path>
            </g>
          </svg>
        </div>
      </div>
    </div>
  </header>
  <div class="login">
    <div class="alerta_erro">
      <div class="card_erro" id="cardErro">
          <span id="mensagem_erro"></span>
      </div>
  </div>
    <div class="section">
      <div class="container">
        <div class="row full-height justify-content-center">
          <div class="col-12 text-center align-self-center py-5">
            <div class="section pb-5 pt-5 pt-sm-2 text-center">
              <h6 class="mb-0 pb-3"><span>Log In </span><span>Cadastre-se</span></h6>
              <input class="checkbox" type="checkbox" id="reg-log" name="reg-log" />
              <label for="reg-log"></label>
              <div class="card-3d-wrap mx-auto">
                <div class="card-3d-wrapper">
                  <div class="card-front">
                    <div class="center-wrap">
                      <div class="section text-center">
                        <a class="arrow" href="../landing_page/landing_page.html"><img src="img/arrow_back.svg"
                            alt=""></a>
                        <h4 class="mb-4 pb-3">Log In</h4>
                        <div class="form-group">
                          <input type="email" name="logemail" class="form-style" placeholder="Email"
                            id="email_input autocomplete=" off>
                          <i class="input-icon uil uil-at"></i>

                        </div>
                        <div class="form-group mt-2">
                          <input type="password" name="logpass" class="form-style" placeholder="Senha" id="logpass"
                            autocomplete="off">
                          <i class="input-icon uil uil-lock-alt"></i>
                        </div>
                        <a href="#" class="btn mt-4">Entrar</a>
                        <p class="mb-0 mt-4 text-center"><a href="#0" class="link">Esqueceu a
                            senha?</a></p>
                      </div>
                    </div>
                  </div>
                  <div class="card-back">
                    <div class="center-wrap">
                      <div class="section text-center">
                        <a class="arrow back" href="index.html"><img src="images/arrow_back.svg" alt=""></a>
                        <h4 class="mb-4 pb-3">Cadastre-se</h4>
                        <form id="myForm">
                      </div>
                      <div class="form-group mt-2">
                        <input class="form-style" placeholder="Nome" id="nome_input" autocomplete="off" required>
                        <i class="input-icon uil uil-user"></i>
                      </div>
                      <div class="form-group mt-2">
                        <input type="email" name="logemail" class="form-style" placeholder="Email" id="email_input"
                          autocomplete="off" required>
                        <i class="input-icon uil uil-at"></i>
                        <span id="email-error" class="error-message"></span>
                      </div>
                      <div class="form-group mt-2">
                        <input type="password" name="logpass" minlength="6" class="form-style" placeholder="Senha"
                          id="senha_input" autocomplete="off" required>
                        <i class="input-icon uil uil-lock-alt"></i>
                        <span id="password-error" class="error-message"></span>
                      </div>
                      <div class="form-group mt-2">
                        <input type="password" name="logpass" minlength="6" class="form-style"
                          placeholder="Confirmar Senha" id="confirmacao_senha_input" autocomplete="off" required>
                        <i class="input-icon uil uil-lock-alt"></i>
                        <span id="confirm-password-error" class="error-message"></span>
                        <div class="cardErro"><span class="mensagem_erro"></span></div>
                      </div>
                      <button type="submit" href="" onclick="cadastrar()" class="btn mt-4">Enviar</button>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  </div>
</body>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.15/jquery.mask.min.js"></script>

</body>

</html>

<script>
  function cadastrar() {

    //Recupere o valor da nova input pelo nome do id
    // Agora vá para o método fetch logo abaixo
    var nomeVar = nome_input.value;
    var emailVar = email_input.value;
    var senhaVar = senha_input.value;
    var confirmacaoSenhaVar = confirmacao_senha_input.value;


    if (nomeVar == "" || emailVar == "" || senhaVar == "" || confirmacaoSenhaVar == "") {
      cardErro.style.display = "block"
      mensagem_erro.innerHTML = "(Mensagem de erro para todos os campos em branco)";

      finalizarAguardar();
      return false;
    }
    else {
      setInterval(sumirMensagem, 5000)
    }

    if (!emailVar.includes("@")) {
      valid = false;
      document.getElementById("email-error").textContent = "O endereço de e-mail deve conter um '@'.";
    } else {
      setInterval(sumirMensagem, 5000)
    }

    if (senhaVar.length < 6) {
      valid = false;
      document.getElementById("password-error").textContent = "A senha deve conter no mínimo 6 caracteres.";
    
      finalizarAguardar();
      return false;

    } else if (!/[A-Z]/.test(senhaVar)) {
      valid = false;
      document.getElementById("password-error").textContent = "A senha deve conter pelo menos uma letra maiúscula.";
      finalizarAguardar();
      return false;

    } else {
      setInterval(sumirMensagem, 5000)
    }

    if (senhaVar !== confirmacaoSenhaVar) {
      valid = false;
      document.getElementById("confirm-password-error").innerHTML = "<span><i class='fas fa-exclamation-triangle'></i>As senhas não coincidem </span>";
      
      finalizarAguardar();
      return false;
    } else {
      setInterval(sumirMensagem, 5000)
    }


    // Enviando o valor da nova input
    fetch("/usuarios/cadastrar", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        // crie um atributo que recebe o valor recuperado aqui
        // Agora vá para o arquivo routes/usuario.js
        nomeServer: nomeVar,
        emailServer: emailVar,
        senhaServer: senhaVar
      })
    }).then(function (resposta) {

      console.log("resposta: ", resposta);

      if (resposta.ok) {
        cardErro.style.display = "block";

        mensagem_erro.innerHTML = "Cadastro realizado com sucesso! Redirecionando para tela de Login...";

        setTimeout(() => {
          window.location = "login.html";
        }, "2000")

        limparFormulario();
        finalizarAguardar();
      } else {
        throw ("Houve um erro ao tentar realizar o cadastro!");
      }
    }).catch(function (resposta) {
      console.log(`#ERRO: ${resposta}`);
      finalizarAguardar();
    });

    return false;
  }

  function sumirMensagem() {
    cardErro.style.display = "none"
  }

</script>